##################################################
# Name: Snakefile
# Description: Main workflow for Document Array
#              Profile experiments
# Date: September 13, 2022
##################################################

configfile: "config/config.yaml"

import glob
import os
import shutil
import random

# variables from config file
exp_type = config["EXP_TYPE"]
pbsim_model = config["PBSIM_MODEL"]
repo_dir = config["REPO_DIRECTORY"]
r_dir = config["RINDEX_BUILD_DIRECTORY"]
base_dir = config["DATA_ROOT"]
time_prog = config["TIME_PROG"]
time_format = config["TIME_FORMAT"]

num_datasets_exp1 = config["NUM_DATASETS_EXP1"]
mem_count_exp1 = config["MEM_COUNT_EXP1"]
thresh_exp1 = config["THRESHOLD_EXP1"]

num_datasets_exp2 = config["NUM_DATASETS_EXP2"]
mem_count_exp2 = config["MEM_COUNT_EXP2"]
thresh_exp2 = config["THRESHOLD_EXP2"]

num_gene_classes_exp3 = config["NUM_GENE_CLASSES_EXP3"]
reads_per_class_exp3 = config["READS_PER_CLASS_EXP3"]

###############################################################################
# IMPORTANT: Sets the working directory based on configuration parameter, and 
#            it can be set on command-line using --config DATA_ROOT=""
###############################################################################
workdir: config["DATA_ROOT"]

###############################################################################
# Imports rules for each type of experiment
###############################################################################

include: "rules/exp_1.smk"
include: "rules/exp_2.smk"
include: "rules/exp_3.smk"

###############################################################################
# All rules for each experiment
###############################################################################

# Experiment 1
# rule all:
#     input:
#         expand("exp1_output_data/{mem_type}/{read_type}/pivot_{num}/output.txt", mem_type=['mems'], read_type=['ont'], num=[1,2,3,4])

# Experiment 2
# rule all:
#     input:
#         expand("exp2_final_output/{mem_type}/{read_type}/output.csv", mem_type=['mems'], read_type=['ont'])

# Experiment 3:
rule all:
    input:
        "exp3_gene_data/raw_seq/class_1.fna"

